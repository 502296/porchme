<!-- أضف سكربت reCAPTCHA v3 في <head> -->

<script src="https://www.google.com/recaptcha/api.js?render=YOUR_RECAPTCHA_SITE_KEY"></script>



<!-- داخل الفورم: غيّر حقل الملف واجعله يدعم multiple -->

<div class="form__item">

  <label class="form__label">Licenses / Insurance (PDF/JPG/PNG) – optional</label>

  <input class="form__control form__control--file" name="credentials" type="file" accept=".pdf,.jpg,.jpeg,.png" multiple />

</div>



<!-- تحت الصفحة (أو في سكربت الإرسال الموجود لديك) -->

<script>

  const SCRIPT_URL = 'YOUR_WEB_APP_URL';



  const formEl    = document.getElementById('builderForm');

  const statusEl  = document.getElementById('status');

  const submitBtn = document.getElementById('submitBtn');



  formEl.addEventListener('submit', async (e) => {

    e.preventDefault();

    statusEl.textContent = '';

    submitBtn.disabled = true; submitBtn.textContent = 'Submitting...';



    // honeypot

    if (formEl.company_url && formEl.company_url.value.trim() !== '') {

      submitBtn.disabled = false; submitBtn.textContent = 'Request Onboarding';

      return;

    }



    try {

      // 1) احصل على توكن reCAPTCHA v3

      const token = await grecaptcha.execute('YOUR_RECAPTCHA_SITE_KEY', {action: 'submit'});

      // 2) جهّز FormData وأضف التوكن

      const fd = new FormData(formEl);

      fd.append('recaptcha_token', token);

      fd.append('recaptcha_action', 'submit');



      // 3) أرسل للويب آب

      const res = await fetch(SCRIPT_URL, { method: 'POST', body: fd });

      const data = await res.json();



      if (data.ok) {

        // توجيه لصفحة شكر

        window.location.href = '/thanks.html';

      } else {

        throw new Error(data.message || 'Unknown error');

      }

    } catch (err) {

      statusEl.classList.add('error');

      statusEl.textContent = '❌ Submission failed. Please try again later.';

      console.error(err);

      submitBtn.disabled = false; submitBtn.textContent = 'Request Onboarding';

    }

  });

</script>
